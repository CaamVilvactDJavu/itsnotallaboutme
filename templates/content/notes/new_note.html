<form id="new-note-form">
  <input
    type="text"
    id="note-title"
    name="title"
    placeholder="Note Title"
    required
  />
  <textarea
    id="note-content"
    name="content"
    cols="80"
    rows="40"
    style="
      background: #000000;
      color: #c6b085;
      border: 2px dotted #000000;
      font-size: 12pt;
    "
    placeholder="Write your note here in Markdown format..."
    required
  ></textarea>
  <button type="submit">Save Note</button>
</form>

<script>
  document
    .getElementById("new-note-form")
    .addEventListener("submit", async (e) => {
      e.preventDefault();
      const title = document.getElementById("note-title").value;
      const content = document.getElementById("note-content").value;

      try {
        const response = await fetch("/api/notes", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            id: Date.now().toString(),
            title,
            content: `# ${title}\n\n${content}`,
          }),
        });

        if (response.ok) {
          alert("Note saved successfully!");
          window.location.href = "/?page=notes";
        } else {
          const errorText = await response.text();
          console.error("Failed to save note:", errorText);
          alert("Failed to save note. Please try again.");
        }
      } catch (error) {
        console.error("Error saving note:", error);
        alert("Error saving note. Please try again.");
      }
    });
</script>
